<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Linuxç³»ç»Ÿè¿ç»´ | gp&#39;s blog</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="å­¦è€Œæ—¶ä¹ ä¹‹ä¸äº¦è¯´ä¹ï¼Œæœ‰æœ‹è‡³è¿œæ–¹æ¥ä¸äº¦ä¹ä¹ã€‚">
    
    <link rel="preload" href="/blog/assets/css/0.styles.203330ab.css" as="style"><link rel="preload" href="/blog/assets/js/app.0cb9d00b.js" as="script"><link rel="preload" href="/blog/assets/js/2.d26acfa2.js" as="script"><link rel="preload" href="/blog/assets/js/14.0983790a.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.a931bf2e.js"><link rel="prefetch" href="/blog/assets/js/11.353f15d9.js"><link rel="prefetch" href="/blog/assets/js/12.f0ad97c6.js"><link rel="prefetch" href="/blog/assets/js/13.b5ab490c.js"><link rel="prefetch" href="/blog/assets/js/15.f1732e7b.js"><link rel="prefetch" href="/blog/assets/js/16.b64c0061.js"><link rel="prefetch" href="/blog/assets/js/3.7989070e.js"><link rel="prefetch" href="/blog/assets/js/4.3d74b074.js"><link rel="prefetch" href="/blog/assets/js/5.300cf98d.js"><link rel="prefetch" href="/blog/assets/js/6.be2c6426.js"><link rel="prefetch" href="/blog/assets/js/7.3826a072.js"><link rel="prefetch" href="/blog/assets/js/8.9eb61706.js"><link rel="prefetch" href="/blog/assets/js/9.d3e328ad.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.203330ab.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">gp's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/article/JavaScript/rule.html" class="nav-link">
  Blog
</a></div><div class="nav-item"><a href="/blog/aboutMe.html" class="nav-link">
  Resume
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/article/JavaScript/rule.html" class="nav-link">
  Blog
</a></div><div class="nav-item"><a href="/blog/aboutMe.html" class="nav-link">
  Resume
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/blog/article/JavaScript/rule.html" class="sidebar-link">å‰ç«¯ä»£ç è§„èŒƒ</a></li><li><a href="/blog/article/JavaScript/QA-daily.html" class="sidebar-link">æ¯æ—¥ä¸€é¢˜  ğŸ’Œ</a></li><li><a href="/blog/article/JavaScript/node.html" class="sidebar-link">javascriptå¸¸ç”¨æ–¹æ³•</a></li><li><a href="/blog/article/Other/git.html" class="sidebar-link">gitçš„ä½¿ç”¨è¯´æ˜</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="linuxç³»ç»Ÿè¿ç»´"><a href="#linuxç³»ç»Ÿè¿ç»´" class="header-anchor">#</a> Linuxç³»ç»Ÿè¿ç»´</h1> <h2 id="nginx-å®‰è£…"><a href="#nginx-å®‰è£…" class="header-anchor">#</a> nginx å®‰è£…</h2> <h3 id="å¼€æ”¾ç«¯å£"><a href="#å¼€æ”¾ç«¯å£" class="header-anchor">#</a> å¼€æ”¾ç«¯å£</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>firewall-cmd --add-port<span class="token operator">=</span><span class="token number">80</span>/tcp --permanent <span class="token operator">&amp;&amp;</span> firewall-cmd --add-port<span class="token operator">=</span><span class="token number">443</span>/tcp --permanent <span class="token operator">&amp;&amp;</span>  firewall-cmd --reload
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="ä¸Šä¼ å®‰è£…åŒ…"><a href="#ä¸Šä¼ å®‰è£…åŒ…" class="header-anchor">#</a> ä¸Šä¼ å®‰è£…åŒ…</h3> <p>å®‰è£…åŒ…ä¸‹è½½è·¯å¾„ï¼š<a href="http://nginx.org/en/download.html" target="_blank" rel="noopener noreferrer">http://nginx.org/en/download.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æœ¬æ¬¡å®‰è£…ç‰ˆæœ¬1.19.5</p> <p>ä¸‹è½½å¥½åä¸Šä¼ åˆ°æœåŠ¡å™¨çš„/dataç›®å½•</p> <p>éœ€è¦å®‰è£…çš„æœåŠ¡å™¨æœ‰ï¼š</p> <ol><li>10.154.73.11</li> <li>10.154.73.12</li> <li>10.154.73.13</li></ol> <h3 id="å®‰è£…"><a href="#å®‰è£…" class="header-anchor">#</a> å®‰è£…</h3> <p>å®‰è£…è¿‡ç¨‹ä¸­å¦‚ç¼ºå°‘ ä»€ä¹ˆä¾èµ–ä¼šåœ¨*./configure*é˜¶æ®µè¿›è¡Œè¯´æ˜ï¼Œåˆ°æ—¶å€™æ ¹æ®ç¼ºå°‘çš„å®‰è£…</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>yum update -y <span class="token comment"># ç³»ç»Ÿç¼ºå°‘åŒ…éœ€è¦å…ˆå‡çº§</span>
<span class="token builtin class-name">cd</span> /data
<span class="token function">tar</span> -xzvf nginx-1.19.5.tar.gz <span class="token operator">&amp;&amp;</span> <span class="token function">mkdir</span> /data/nginx 
yum <span class="token function">install</span> -y pcre-devel openssl-devel
<span class="token builtin class-name">cd</span> /data/nginx-1.19.5 <span class="token operator">&amp;&amp;</span> ./configure --prefix<span class="token operator">=</span>/data/nginx/ --sbin-path<span class="token operator">=</span>/data/nginx/nginx --conf-path<span class="token operator">=</span>/data/nginx/nginx.conf --pid-path<span class="token operator">=</span>/data/nginx/nginx.pid --with-http_ssl_module  --with-stream --with-stream_ssl_module --with-http_stub_status_module
<span class="token function">make</span> <span class="token operator">&amp;&amp;</span> <span class="token function">make</span> <span class="token function">install</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="å¯åŠ¨"><a href="#å¯åŠ¨" class="header-anchor">#</a> å¯åŠ¨</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>/data/nginx/nginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="httpsè¯ä¹¦å®‰è£…"><a href="#httpsè¯ä¹¦å®‰è£…" class="header-anchor">#</a> httpsè¯ä¹¦å®‰è£…</h3> <p>ä¸Šä¼ è¯ä¹¦æ–‡ä»¶åˆ°æœåŠ¡å™¨çš„/dataç›®å½•ï¼Œæ‰§è¡Œè§£å‹å‘½ä»¤åˆ°nginxç›®å½•</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">mkdir</span> -p /data/nginx/ssl/ <span class="token operator">&amp;&amp;</span> <span class="token function">unzip</span> /data/4729317__zhenergy.com.cn_nginx.zip -d /data/nginx/ssl/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="ä¿®æ”¹nginxé…ç½®æ–‡ä»¶"><a href="#ä¿®æ”¹nginxé…ç½®æ–‡ä»¶" class="header-anchor">#</a> ä¿®æ”¹nginxé…ç½®æ–‡ä»¶</h3> <p>nginxé…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#user  nobody;</span>
worker_processes  <span class="token number">16</span><span class="token punctuation">;</span>
worker_rlimit_nofile <span class="token number">20960</span><span class="token punctuation">;</span>
events <span class="token punctuation">{</span>
    accept_mutex on<span class="token punctuation">;</span>
    accept_mutex_delay 500ms<span class="token punctuation">;</span>
    worker_connections  <span class="token number">1024</span><span class="token punctuation">;</span>
    multi_accept on<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
http <span class="token punctuation">{</span>
    include       mime.types<span class="token punctuation">;</span>
    default_type  application/octet-stream<span class="token punctuation">;</span>
    <span class="token comment"># åå°ç½‘å…³æœåŠ¡</span>
    upstream unionServer <span class="token punctuation">{</span>
        server <span class="token number">10.154</span>.73.11:8035 <span class="token assign-left variable">weight</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
        server <span class="token number">10.154</span>.73.12:8035 <span class="token assign-left variable">weight</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
        server <span class="token number">10.154</span>.73.13:8035 <span class="token assign-left variable">weight</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment"># æ–‡ä»¶é¢„è§ˆæœåŠ¡å™¨</span>
    upstream onlinePreview <span class="token punctuation">{</span>
       server <span class="token number">10.154</span>.73.11:7205 <span class="token assign-left variable">weight</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    sendfile        on<span class="token punctuation">;</span>
    keepalive_timeout  <span class="token number">65</span><span class="token punctuation">;</span>
    <span class="token function">gzip</span>  on<span class="token punctuation">;</span>
    server <span class="token punctuation">{</span>
        listen       <span class="token number">80</span><span class="token punctuation">;</span>
        server_name  localhost<span class="token punctuation">;</span>
        <span class="token comment">#charset koi8-r;</span>
        <span class="token comment">#access_log  logs/host.access.log  main;</span>
        add_header strict-transport-security max-age<span class="token operator">=</span><span class="token number">15552000</span><span class="token punctuation">;</span>
        add_header x-content-type-options nosniff<span class="token punctuation">;</span>
        add_header x-dns-prefetch-control off<span class="token punctuation">;</span>
        add_header x-download-options noopen<span class="token punctuation">;</span>
        <span class="token comment">#add_header x-frame-options SAMEORIGIN;</span>
        proxy_set_header Upgrade <span class="token variable">$http_upgrade</span><span class="token punctuation">;</span>
        proxy_set_header Connection <span class="token string">&quot;upgrade&quot;</span><span class="token punctuation">;</span>
        location / <span class="token punctuation">{</span>
            root   html<span class="token punctuation">;</span>
            index  index.html index.htm<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        location /api/ <span class="token punctuation">{</span>
            proxy_pass http://unionServer/<span class="token punctuation">;</span>
            proxy_redirect     off<span class="token punctuation">;</span>
            proxy_set_header   Host             <span class="token variable">$http_host</span><span class="token punctuation">;</span>
            proxy_set_header   X-Real-IP        <span class="token variable">$remote_addr</span><span class="token punctuation">;</span>
            proxy_set_header   X-Forwarded-For  <span class="token variable">$proxy_add_x_forwarded_for</span><span class="token punctuation">;</span>
            proxy_set_header Upgrade <span class="token variable">$http_upgrade</span><span class="token punctuation">;</span>
            proxy_set_header Connection <span class="token string">&quot;upgrade&quot;</span><span class="token punctuation">;</span>
       <span class="token punctuation">}</span>
        error_page   <span class="token number">500</span> <span class="token number">502</span> <span class="token number">503</span> <span class="token number">504</span>  /50x.html<span class="token punctuation">;</span>
        location <span class="token operator">=</span> /50x.html <span class="token punctuation">{</span>
            root   html<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment"># HTTPS server</span>
    <span class="token comment">#</span>
    server <span class="token punctuation">{</span>
        listen       <span class="token number">443</span> ssl<span class="token punctuation">;</span>
        server_name  zhenergy.com.cn<span class="token punctuation">;</span>
        ssl_certificate      /data/nginx/ssl/4729317__zhenergy.com.cn.pem<span class="token punctuation">;</span>
        ssl_certificate_key   /data/nginx/ssl/4729317__zhenergy.com.cn.key<span class="token punctuation">;</span>
        ssl_session_cache    shared:SSL:1m<span class="token punctuation">;</span>
        ssl_session_timeout  5m<span class="token punctuation">;</span>
        ssl_protocols TLSv1 TLSv1.1 TLSv1.2<span class="token punctuation">;</span>
	    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:<span class="token operator">!</span>NULL:<span class="token operator">!</span>aNULL:<span class="token operator">!</span>MD5:<span class="token operator">!</span>ADH:<span class="token operator">!</span>RC4<span class="token punctuation">;</span>
        ssl_prefer_server_ciphers  on<span class="token punctuation">;</span>


        add_header strict-transport-security max-age<span class="token operator">=</span><span class="token number">15552000</span><span class="token punctuation">;</span>
        add_header x-content-type-options nosniff<span class="token punctuation">;</span>
        add_header x-dns-prefetch-control off<span class="token punctuation">;</span>
        add_header x-download-options noopen<span class="token punctuation">;</span>
        <span class="token comment">#add_header x-frame-options SAMEORIGIN;</span>
        proxy_set_header Upgrade <span class="token variable">$http_upgrade</span><span class="token punctuation">;</span>
        proxy_set_header Connection <span class="token string">&quot;upgrade&quot;</span><span class="token punctuation">;</span>

        location / <span class="token punctuation">{</span>
            root   html<span class="token punctuation">;</span>
            index  index.html index.htm<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>


        location /api/ <span class="token punctuation">{</span>
            proxy_pass http://unionServer/<span class="token punctuation">;</span>
            proxy_redirect     off<span class="token punctuation">;</span>
            proxy_set_header   Host             <span class="token variable">$http_host</span><span class="token punctuation">;</span>
            proxy_set_header   X-Real-IP        <span class="token variable">$remote_addr</span><span class="token punctuation">;</span>
            proxy_set_header   X-Forwarded-For  <span class="token variable">$proxy_add_x_forwarded_for</span><span class="token punctuation">;</span>
            proxy_set_header Upgrade <span class="token variable">$http_upgrade</span><span class="token punctuation">;</span>
            proxy_set_header Connection <span class="token string">&quot;upgrade&quot;</span><span class="token punctuation">;</span>
       <span class="token punctuation">}</span>


       location /onlinePreview/ <span class="token punctuation">{</span>
            proxy_pass http://onlinePreview/onlinePreview/<span class="token punctuation">;</span>
            proxy_redirect     off<span class="token punctuation">;</span>
            proxy_set_header   Host             <span class="token variable">$http_host</span><span class="token punctuation">;</span>
            proxy_set_header   X-Real-IP        <span class="token variable">$remote_addr</span><span class="token punctuation">;</span>
            proxy_set_header   X-Forwarded-For  <span class="token variable">$proxy_add_x_forwarded_for</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br></div></div><h3 id="é‡æ–°åŠ è½½é…ç½®"><a href="#é‡æ–°åŠ è½½é…ç½®" class="header-anchor">#</a> é‡æ–°åŠ è½½é…ç½®</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>/data/nginx/nginx -s reload
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="jdkå®‰è£…"><a href="#jdkå®‰è£…" class="header-anchor">#</a> jdkå®‰è£…</h2> <p>æœ¬æ¬¡å®‰è£…çš„jdkç‰ˆæœ¬ä¸º<em>1.8.211</em></p> <p>ä¸‹è½½å¥½åä¸Šä¼ åˆ°æœåŠ¡å™¨çš„/dataç›®å½•</p> <p>éœ€è¦å®‰è£…çš„æœåŠ¡å™¨æœ‰ï¼š</p> <ol><li>10.154.73.11</li> <li>10.154.73.12</li> <li>10.154.73.13</li></ol> <h3 id="å®‰è£…-2"><a href="#å®‰è£…-2" class="header-anchor">#</a> å®‰è£…</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">mkdir</span> /usr/local/lib/java-1.8 -p
<span class="token function">tar</span> -xzvf /data/jdk-8u211-linux-x64.tar.gz -C /usr/local/lib/java-1.8
<span class="token function">ln</span> -s /usr/local/lib/java-1.8/jdk1.8.0_211/bin/java /usr/local/bin/java

<span class="token builtin class-name">echo</span> <span class="token string">'export JAVA_HOME=/usr/local/lib/java-1.8/jdk1.8.0_211'</span> <span class="token operator">&gt;&gt;</span> /etc/profile
<span class="token builtin class-name">echo</span> <span class="token string">'export PATH=<span class="token environment constant">$PATH</span>:<span class="token variable">$JAVA_HOME</span>/bin'</span> <span class="token operator">&gt;&gt;</span> /etc/profile
<span class="token builtin class-name">source</span> /etc/profile

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="redis-å®‰è£…"><a href="#redis-å®‰è£…" class="header-anchor">#</a> redis å®‰è£…</h2> <p>ä¸‹è½½åœ°å€ï¼š<a href="https://redis.io/download" target="_blank" rel="noopener noreferrer">https://redis.io/download<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>ä¸‹è½½å¥½åä¸Šä¼ åˆ°æœåŠ¡å™¨çš„/dataç›®å½•</p> <p>æœ¬æ¬¡å®‰è£…ç‰ˆæœ¬ï¼š5.0.4</p> <p>6+ç‰ˆæœ¬çš„redisæœåŠ¡å™¨ä¸æ”¯æŒå®‰è£…</p> <p>éœ€è¦å®‰è£…çš„æœåŠ¡å™¨æœ‰</p> <ol><li>10.154.73.11</li> <li>10.154.73.12</li> <li>10.154.73.13</li></ol> <h3 id="å¼€é€šç«¯å£è®¿é—®"><a href="#å¼€é€šç«¯å£è®¿é—®" class="header-anchor">#</a> å¼€é€šç«¯å£è®¿é—®</h3> <p>ä¸‰å°æœåŠ¡å™¨éƒ½éœ€è¦å¼€é€š</p> <div class="language- line-numbers-mode"><pre class="language-text"><code> firewall-cmd --add-port=7000-7002/tcp --permanent &amp;&amp;  firewall-cmd --reload
 firewall-cmd --add-port=17000-17002/tcp --permanent &amp;&amp;  firewall-cmd --reload
 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="å®‰è£…-3"><a href="#å®‰è£…-3" class="header-anchor">#</a> å®‰è£…</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">tar</span> -xzvf /data/redis-5.0.4.tar.gz -C /data
<span class="token builtin class-name">cd</span> /data/redis-5.0.4 <span class="token operator">&amp;&amp;</span> <span class="token function">make</span> <span class="token operator">&amp;&amp;</span> <span class="token function">make</span> <span class="token function">install</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="é…ç½®"><a href="#é…ç½®" class="header-anchor">#</a> é…ç½®</h3> <p>æœ¬æ¬¡å®‰è£…é‡‡ç”¨é›†ç¾¤æ¨¡å¼ï¼Œæ¯ä¸ªæœåŠ¡å™¨è¿è¡Œä¸‰ä¸ªredisé›†ç¾¤èŠ‚ç‚¹ï¼Œåˆ†åˆ«ä¸º7000,7001,7002ã€‚é¦–å…ˆåˆ›å»ºredisçš„æ•°æ®ç›®å½•,åˆ›å»ºé»˜è®¤çš„é…ç½®</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">mkdir</span> /data/redis/7000 -p <span class="token operator">&amp;&amp;</span> <span class="token function">mkdir</span> /data/redis/7001 -p <span class="token operator">&amp;&amp;</span> <span class="token function">mkdir</span> /data/redis/7002 -p
<span class="token function">cp</span> /data/redis-5.0.4/redis.conf /data/redis/redis.7000.conf
<span class="token function">vim</span> /data/redis/redis.7000.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>ä¿®æ”¹7000ç«¯å£çš„é»˜è®¤é…ç½®</p> <ol><li>69è¡Œä¿®æ”¹bindä¸ºï¼š<code>bind 0.0.0.0</code></li> <li>92è¡Œä¿®æ”¹portä¸ºï¼š<code>port 7000</code></li> <li>136è¡Œä¿®æ”¹daemonizeä¸ºï¼š<code>daemonize yes</code></li> <li>158è¡Œä¿®æ”¹pidfileä¸ºï¼š<code>pidfile /var/run/redis_7000.pid</code></li> <li>186è¡Œä¿®æ”¹databasesï¼š<code>databases 1</code></li> <li>263è¡Œä¿®æ”¹dirï¼š<code>dir /data/redis/7000</code></li> <li>507è¡Œä¿®æ”¹requirepassï¼š<code>requirepass redis@2021</code></li> <li>699è¡Œä¿®æ”¹appendonlyï¼š <code>appendonly yes</code></li> <li>838è¡Œä¿®æ”¹cluster-enabledï¼š<code>cluster-enabled yes</code></li> <li>846è¡Œä¿®æ”¹cluster-config-fileï¼š<code>cluster-config-file nodes-7000.conf</code></li></ol> <p>åŒç†åˆ›å»º<em>redis.7001.conf</em>ä»¥åŠ**redis.7002.conf*æ–‡ä»¶ï¼Œä¿®æ”¹é…ç½®ä¸­7000çš„é…ç½®ä¸ºç›¸åº”çš„7001å’Œ7002</p> <h3 id="å¯åŠ¨-2"><a href="#å¯åŠ¨-2" class="header-anchor">#</a> å¯åŠ¨</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>redis-server /data/redis/redis.7000.conf <span class="token operator">&amp;&amp;</span> redis-server /data/redis/redis.7001.conf <span class="token operator">&amp;&amp;</span> redis-server /data/redis/redis.7002.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="åˆ›å»ºé›†ç¾¤"><a href="#åˆ›å»ºé›†ç¾¤" class="header-anchor">#</a> åˆ›å»ºé›†ç¾¤</h3> <p>åœ¨ä¸‰å°æœåŠ¡å™¨éƒ½è¿›è¡Œäº†å¦‚ä¸Šæ­¥éª¤æ—¶å³å¯å¯åŠ¨é›†ç¾¤ï¼Œåœ¨ä»»æ„ä¸€å°æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å³å¯</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>redis-cli -a redis@2021 --cluster create <span class="token number">10.154</span>.73.11:7000 <span class="token number">10.154</span>.73.11:7001 <span class="token number">10.154</span>.73.11:7002 <span class="token number">10.154</span>.73.12:7000 <span class="token number">10.154</span>.73.12:7001 <span class="token number">10.154</span>.73.12:7002 <span class="token number">10.154</span>.73.13:7000 <span class="token number">10.154</span>.73.13:7001 <span class="token number">10.154</span>.73.13:7002 --cluster-replicas <span class="token number">2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æŸ¥çœ‹é›†ç¾¤çŠ¶æ€</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>redis-cli -a redis@2021 --cluster info <span class="token number">10.154</span>.73.11:7000
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="zookeeper-å®‰è£…"><a href="#zookeeper-å®‰è£…" class="header-anchor">#</a> zookeeper å®‰è£…</h2> <p>æœ¬æ¬¡å®‰è£…zookeeperç‰ˆæœ¬ä¸ºï¼š3.5.5</p> <p>ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨çš„/dataç›®å½•</p> <p>éœ€è¦å®‰è£…çš„æœåŠ¡å™¨æœ‰</p> <ol><li>10.154.73.11</li> <li>10.154.73.12</li> <li>10.154.73.13</li></ol> <h3 id="å¼€æ”¾ç«¯å£-2"><a href="#å¼€æ”¾ç«¯å£-2" class="header-anchor">#</a> å¼€æ”¾ç«¯å£</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>firewall-cmd --add-port<span class="token operator">=</span><span class="token number">2181</span>/tcp --permanent <span class="token operator">&amp;&amp;</span>  firewall-cmd --add-port<span class="token operator">=</span><span class="token number">2888</span>/tcp --permanent <span class="token operator">&amp;&amp;</span>  firewall-cmd --add-port<span class="token operator">=</span><span class="token number">3888</span>/tcp --permanent <span class="token operator">&amp;&amp;</span>  firewall-cmd --reload
 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="å®‰è£…-4"><a href="#å®‰è£…-4" class="header-anchor">#</a> å®‰è£…</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">tar</span> -xzvf /data/apache-zookeeper-3.5.5-bin.tar.gz -C /data

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="é…ç½®-2"><a href="#é…ç½®-2" class="header-anchor">#</a> é…ç½®</h3> <p>å¤åˆ¶é…ç½®æ¨¡æ¿</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">cp</span> /data/apache-zookeeper-3.5.5-bin/conf/zoo_sample.cfg /data/apache-zookeeper-3.5.5-bin/conf/zoo.cfg

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>ä¿®æ”¹é…ç½®å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre><code>1. 12è¡Œï¼š`dataDir=/data/zookeeper`
</code></pre></div><p>æ·»åŠ é…ç½®å¦‚ä¸‹:</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>server.11<span class="token operator">=</span><span class="token number">10.154</span>.73.11:2888:3888
server.12<span class="token operator">=</span><span class="token number">10.154</span>.73.12:2888:3888
server.13<span class="token operator">=</span><span class="token number">10.154</span>.73.13:2888:3888
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="å¯åŠ¨-3"><a href="#å¯åŠ¨-3" class="header-anchor">#</a> å¯åŠ¨</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">mkdir</span> /data/zookeeper
<span class="token builtin class-name">echo</span> <span class="token number">11</span> <span class="token operator">&gt;</span> /data/zookeeper/myid <span class="token comment">#è®¾ç½®idï¼Œä¸ºæœåŠ¡å™¨ipæœ€åç½‘æ®µ,å³11åœ¨ä¸‰å°æœåŠ¡å™¨åˆ†åˆ«å¯¹åº”11ï¼Œ12,13</span>
/data/apache-zookeeper-3.5.5-bin/bin/zkServer.sh start

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="æŸ¥çœ‹é›†ç¾¤çŠ¶æ€"><a href="#æŸ¥çœ‹é›†ç¾¤çŠ¶æ€" class="header-anchor">#</a> æŸ¥çœ‹é›†ç¾¤çŠ¶æ€</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>/data/apache-zookeeper-3.5.5-bin/bin/zkServer.sh status

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="elasticsearch-å®‰è£…"><a href="#elasticsearch-å®‰è£…" class="header-anchor">#</a> elasticsearch å®‰è£…</h2> <p>æœ¬æ¬¡å®‰è£…çš„ç‰ˆæœ¬ä¸ºï¼š7.7.1</p> <p>éœ€è¦å®‰è£…çš„æœåŠ¡å™¨æœ‰</p> <ol><li>10.154.73.11</li> <li>10.154.73.12</li> <li>10.154.73.13</li></ol> <h3 id="åˆ›å»ºç”¨æˆ·"><a href="#åˆ›å»ºç”¨æˆ·" class="header-anchor">#</a> åˆ›å»ºç”¨æˆ·</h3> <p>å› <code>Elasticsearch</code>ä¸èƒ½åœ¨rootç”¨æˆ·ä¸‹è¿è¡Œ,éœ€è¦åˆ›å»ºæ–°çš„ç”¨æˆ·</p> <div class="language-sheel line-numbers-mode"><pre class="language-text"><code>groupadd -g 9200 elasticsearch
useradd -u 9200 -g elasticsearch -d /home/elasticsearch elasticsearch
passwd elasticsearch # å¯†ç elastic@2021

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="åˆ›å»ºç›®å½•å¹¶èµ‹æƒ"><a href="#åˆ›å»ºç›®å½•å¹¶èµ‹æƒ" class="header-anchor">#</a> åˆ›å»ºç›®å½•å¹¶èµ‹æƒ</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">tar</span> -xzvf /data/elasticsearch-7.7.1-linux-x86_64.tar.gz -C /data
<span class="token function">mkdir</span> -p /data/elasticsearch/data <span class="token operator">&amp;&amp;</span> <span class="token function">mkdir</span> -p /data/elasticsearch/log <span class="token operator">&amp;&amp;</span> <span class="token function">chown</span> -R elasticsearch:elasticsearch /data/elasticsearch

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="ä¿®æ”¹ç³»ç»Ÿé…ç½®æ–‡ä»¶"><a href="#ä¿®æ”¹ç³»ç»Ÿé…ç½®æ–‡ä»¶" class="header-anchor">#</a> ä¿®æ”¹ç³»ç»Ÿé…ç½®æ–‡ä»¶</h3> <p>ä¸ºä»¥ä¸‹é…ç½®æ–‡ä»¶æ·»åŠ å„è‡ªçš„å±æ€§ï¼Œç„¶åé‡æ–°ç™»å½•</p> <ol><li><code>/etc/sysctl.conf</code> <ol><li><code>vm.max_map_count=655300</code></li></ol></li> <li><code>/etc/security/limits.conf</code> <ol><li><code>* soft nofile 65536</code></li> <li><code>* hard nofile 65536</code></li> <li><code>* hard memlock unlimited</code></li> <li><code>* soft memlock unlimited</code></li></ol></li></ol> <h3 id="ä¿®æ”¹é…ç½®æ–‡ä»¶"><a href="#ä¿®æ”¹é…ç½®æ–‡ä»¶" class="header-anchor">#</a> ä¿®æ”¹é…ç½®æ–‡ä»¶</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">vim</span> /data/elasticsearch-7.7.1/config/elasticsearch.yml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="mysql-å®‰è£…"><a href="#mysql-å®‰è£…" class="header-anchor">#</a> mysql å®‰è£…</h2> <p>æœ¬æ¬¡å®‰è£…ç‰ˆæœ¬ä¸ºï¼š5.7.26</p> <p>ä¸Šä¼ æ–‡ä»¶åˆ°æ•°æ®åº“æœåŠ¡å™¨ï¼š</p> <div class="language- extra-class"><pre><code>1. 10.154.73.14
2. 10.154.73.15
</code></pre></div><h3 id="å¼€æ”¾ç«¯å£-3"><a href="#å¼€æ”¾ç«¯å£-3" class="header-anchor">#</a> å¼€æ”¾ç«¯å£</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>firewall-cmd --add-port<span class="token operator">=</span><span class="token number">3306</span>/tcp --permanent <span class="token operator">&amp;&amp;</span>  firewall-cmd --reload
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="å‡çº§ç³»ç»Ÿ"><a href="#å‡çº§ç³»ç»Ÿ" class="header-anchor">#</a> å‡çº§ç³»ç»Ÿ</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>yum update -y
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="å®‰è£…-5"><a href="#å®‰è£…-5" class="header-anchor">#</a> å®‰è£…</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">mkdir</span> /data/mysql-rpm <span class="token operator">&amp;&amp;</span> <span class="token function">tar</span> -xvf /data/mysql-5.7.26-1.el7.x86_64.rpm-bundle.tar -C /data/mysql-rpm <span class="token comment">#è§£å‹</span>
yum <span class="token function">install</span> -y openssl-devel net-tools perl-JSON autoconf <span class="token comment">#å®‰è£…ä¾èµ–</span>
<span class="token function">rpm</span> -qa<span class="token operator">|</span><span class="token function">grep</span> mariadb <span class="token comment">#æŸ¥è¯¢æ˜¯å¦å®‰è£…äº†mariadbï¼Œå¦‚æœå®‰è£…äº†åˆ™éœ€è¦å¸è½½</span>
<span class="token function">rpm</span> -e --nodeps mariadb-libs-5.5.68-1.el7.x86_64 <span class="token comment">#å¸è½½</span>
<span class="token builtin class-name">cd</span> /data/mysql-rpm <span class="token operator">&amp;&amp;</span> <span class="token function">rpm</span> -ivh mysql-community-<span class="token punctuation">{</span>common,libs,libs-compat,client,devel,server,embedded-compat,embedded-devel,embedded<span class="token punctuation">}</span>-5.7.26-1.el7.x86_64.rpm <span class="token comment">#å®‰è£…</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="åˆ›å»ºæ•°æ®ç›®å½•"><a href="#åˆ›å»ºæ•°æ®ç›®å½•" class="header-anchor">#</a> åˆ›å»ºæ•°æ®ç›®å½•</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">mkdir</span> -p /data/mysql/data
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="ä¿®æ”¹é…ç½®æ–‡ä»¶-2"><a href="#ä¿®æ”¹é…ç½®æ–‡ä»¶-2" class="header-anchor">#</a> ä¿®æ”¹é…ç½®æ–‡ä»¶</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">vim</span> /etc/my.cnf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol><li>20è¡Œï¼š<code>datadir=/data/mysql/data</code></li> <li>26è¡Œï¼š<code>log-error=/data/mysql/mysqld.log</code></li> <li>28è¡Œï¼š<code>lower_case_table_names=1</code></li></ol> <h3 id="åˆå§‹åŒ–æ•°æ®åº“"><a href="#åˆå§‹åŒ–æ•°æ®åº“" class="header-anchor">#</a> åˆå§‹åŒ–æ•°æ®åº“</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>mysqld --initialize --user<span class="token operator">=</span>root --datadir<span class="token operator">=</span>/data/mysql/data --explicit_defaults_for_timestamp  <span class="token operator">&amp;&amp;</span> <span class="token function">chmod</span> -R <span class="token number">777</span> /data/mysql/*
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="å¯åŠ¨-4"><a href="#å¯åŠ¨-4" class="header-anchor">#</a> å¯åŠ¨</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>systemctl start  mysqld
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="æŸ¥çœ‹é»˜è®¤å¯†ç "><a href="#æŸ¥çœ‹é»˜è®¤å¯†ç " class="header-anchor">#</a> æŸ¥çœ‹é»˜è®¤å¯†ç </h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">grep</span> <span class="token string">'temporary password'</span> /data/mysql/mysqld.log

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="ä¿®æ”¹é»˜è®¤å¯†ç "><a href="#ä¿®æ”¹é»˜è®¤å¯†ç " class="header-anchor">#</a> ä¿®æ”¹é»˜è®¤å¯†ç </h3> <p>ä½¿ç”¨é»˜è®¤å¯†ç ç™»å½•åä¿®æ”¹å¯†ç </p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>mysql -uroot -p
ALTER <span class="token environment constant">USER</span> user<span class="token punctuation">(</span><span class="token punctuation">)</span> IDENTIFIED BY <span class="token string">'kZfDYTCUmsqj2XBA'</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="åˆ›å»ºåº”ç”¨æ•°æ®åº“"><a href="#åˆ›å»ºåº”ç”¨æ•°æ®åº“" class="header-anchor">#</a> åˆ›å»ºåº”ç”¨æ•°æ®åº“</h3> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code>create user zngh@'%' IDENTIFIED WITH 'mysql_native_password' BY 'sHvMu5C3fJYolagh';
create database zngh CHARACTER SET utf8 COLLATE utf8_general_ci;
grant all privileges on zngh.* to zngh;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="é…ç½®ä¸»ä»å¤åˆ¶"><a href="#é…ç½®ä¸»ä»å¤åˆ¶" class="header-anchor">#</a> é…ç½®ä¸»ä»å¤åˆ¶</h3> <p>ä»¥ä¸‹æ“ä½œéœ€è¦è¿æ¥æ•°æ®åº“åæ“ä½œ</p> <ol><li>åˆ›å»ºç”¨äºåŒæ­¥æ•°æ®çš„è´¦å·</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>grant replication slave on *.* to <span class="token string">'replicate'</span> identified by <span class="token string">'9FurhTCnIwZtAgqR'</span><span class="token punctuation">;</span>
flush privileges<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_14æ•°æ®åº“"><a href="#_14æ•°æ®åº“" class="header-anchor">#</a> 14æ•°æ®åº“</h4> <h5 id="é…ç½®ä¿®æ”¹"><a href="#é…ç½®ä¿®æ”¹" class="header-anchor">#</a> é…ç½®ä¿®æ”¹</h5> <p>vim /etc/my.cnf</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># For advice on how to change settings please see</span>
<span class="token comment"># http://dev.mysql.com/doc/refman/5.7/en/server-configuration-defaults.html</span>
<span class="token punctuation">[</span>client<span class="token punctuation">]</span>
<span class="token assign-left variable">default_character_set</span><span class="token operator">=</span>utf8mb4
<span class="token punctuation">[</span>mysqld<span class="token punctuation">]</span>
collation_server <span class="token operator">=</span> utf8mb4_general_ci
character_set_server <span class="token operator">=</span> utf8mb4

<span class="token comment">#</span>
<span class="token comment"># Remove leading # and set to the amount of RAM for the most important data</span>
<span class="token comment"># cache in MySQL. Start at 70% of total RAM for dedicated server, else 10%.</span>
<span class="token comment"># innodb_buffer_pool_size = 128M</span>
<span class="token comment">#</span>
<span class="token comment"># Remove leading # to turn on a very important data integrity option: logging</span>
<span class="token comment"># changes to the binary log between backups.</span>
<span class="token assign-left variable">log_bin</span><span class="token operator">=</span>mysql-bin
<span class="token comment">#</span>
<span class="token comment"># Remove leading # to set options mainly useful for reporting servers.</span>
<span class="token comment"># The server defaults are faster for transactions and fast SELECTs.</span>
<span class="token comment"># Adjust sizes as needed, experiment to find the optimal values.</span>
<span class="token comment"># join_buffer_size = 128M</span>
<span class="token comment"># sort_buffer_size = 2M</span>
<span class="token comment"># read_rnd_buffer_size = 2M</span>
<span class="token assign-left variable">datadir</span><span class="token operator">=</span>/data/mysql/data
<span class="token assign-left variable">socket</span><span class="token operator">=</span>/var/lib/mysql/mysql.sock

<span class="token comment"># Disabling symbolic-links is recommended to prevent assorted security risks</span>
symbolic-links<span class="token operator">=</span><span class="token number">0</span>

log-error<span class="token operator">=</span>/data/mysql/mysqld.log
pid-file<span class="token operator">=</span>/var/run/mysqld/mysqld.pid


binlog-format<span class="token operator">=</span>mixed

<span class="token comment">#ä¸»æ ‡æœåŠ¡æ ‡è¯†å·,å¿…éœ€å”¯ä¸€</span>
server-id<span class="token operator">=</span><span class="token number">14</span>
<span class="token comment"># å¿½ç•¥å¤§å°å†™</span>
<span class="token assign-left variable">lower_case_table_names</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token comment"># è®°å½•æ—¥å¿—çš„æ•°æ®åº“</span>
binlog-do-db<span class="token operator">=</span>zngh

<span class="token comment">#ä¸è®°å½•æ—¥å¿—çš„åº“,å³ä¸éœ€è¦åŒæ­¥çš„åº“</span>

binlog-ignore-db<span class="token operator">=</span>mysql
<span class="token comment">#ç”¨ä»å±æœåŠ¡å™¨ä¸Šçš„æ—¥å¿—åŠŸèƒ½</span>

log-slave-updates

<span class="token comment">#ç»è¿‡1æ—¥å¿—å†™æ“ä½œå°±æŠŠæ—¥å¿—æ–‡ä»¶å†™å…¥ç¡¬ç›˜ä¸€æ¬¡(å¯¹æ—¥å¿—ä¿¡æ¯è¿›è¡Œä¸€æ¬¡åŒæ­¥)ã€‚n=1æ˜¯æœ€å®‰å…¨çš„åšæ³•ï¼Œä½†æ•ˆç‡æœ€ä½ã€‚é»˜è®¤è®¾ç½®æ˜¯n=0ã€‚</span>

<span class="token assign-left variable">sync_binlog</span><span class="token operator">=</span><span class="token number">1</span>

<span class="token comment"># auto_incrementï¼Œæ§åˆ¶è‡ªå¢åˆ—AUTO_INCREMENTçš„è¡Œä¸º</span>

<span class="token comment"># auto_increment_offsetï¼1è®¾ç½®æ­¥é•¿,è¿™é‡Œè®¾ç½®ä¸º1,è¿™æ ·Masterçš„auto_incrementå­—æ®µäº§ç”Ÿçš„æ•°å€¼æ˜¯:1, 3, 5, 7, â€¦ç­‰å¥‡æ•°ID</span>
<span class="token assign-left variable">auto_increment_offset</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token comment"># auto_increment_increment=næœ‰å¤šå°‘å°æœåŠ¡å™¨ï¼Œnå°±è®¾ç½®ä¸ºå¤šå°‘</span>
<span class="token assign-left variable">auto_increment_increment</span><span class="token operator">=</span><span class="token number">2</span>

<span class="token comment">#è¿›è¡Œé•œåƒå¤„ç†çš„æ•°æ®åº“</span>

replicate-do-db <span class="token operator">=</span> zngh

<span class="token comment">#ä¸è¿›è¡Œé•œåƒå¤„ç†çš„æ•°æ®åº“</span>

replicate-ignore-db<span class="token operator">=</span> mysql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br></div></div><h5 id="æŸ¥çœ‹15æ•°æ®åº“åç§»"><a href="#æŸ¥çœ‹15æ•°æ®åº“åç§»" class="header-anchor">#</a> æŸ¥çœ‹15æ•°æ®åº“åç§»</h5> <p>rootè´¦å·è¿›å…¥15æ•°æ®åº“æŸ¥çœ‹åç§»é‡</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>mysql <span class="token operator">&gt;</span> show master status<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-mysql line-numbers-mode"><pre class="language-text"><code>+------------------+----------+--------------+------------------+-------------------+
| File             | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set |
+------------------+----------+--------------+------------------+-------------------+
| mysql-bin.000003 |      154 | zngh         | mysql            |                   |
+------------------+----------+--------------+------------------+-------------------+

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h5 id="_14æ•°æ®åº“è®¾ç½®åŒæ­¥"><a href="#_14æ•°æ®åº“è®¾ç½®åŒæ­¥" class="header-anchor">#</a> 14æ•°æ®åº“è®¾ç½®åŒæ­¥</h5> <p>å…¶ä¸­master_log_fileå’Œmaster_log_posçš„å€¼æ¥æºäºå¦å¤–ä¸€å°æ•°æ®åº“çš„åç§»é‡ç»“æœ</p> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code>stop slave;
change master to master_host='10.154.73.15', master_user='replicate', master_password='9FurhTCnIwZtAgqR', master_log_file='mysql-bin.000003', master_log_pos=154;
start slave;
show slave status\G;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="_15æ•°æ®åº“"><a href="#_15æ•°æ®åº“" class="header-anchor">#</a> 15æ•°æ®åº“</h4> <h5 id="é…ç½®ä¿®æ”¹-2"><a href="#é…ç½®ä¿®æ”¹-2" class="header-anchor">#</a> é…ç½®ä¿®æ”¹</h5> <p>vim /etc/my.cnf</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># For advice on how to change settings please see</span>
<span class="token comment"># http://dev.mysql.com/doc/refman/5.7/en/server-configuration-defaults.html</span>

<span class="token punctuation">[</span>client<span class="token punctuation">]</span>
<span class="token assign-left variable">default_character_set</span><span class="token operator">=</span>utf8mb4
<span class="token punctuation">[</span>mysqld<span class="token punctuation">]</span>
collation_server <span class="token operator">=</span> utf8mb4_general_ci
character_set_server <span class="token operator">=</span> utf8mb4

<span class="token comment">#</span>
<span class="token comment"># Remove leading # and set to the amount of RAM for the most important data</span>
<span class="token comment"># cache in MySQL. Start at 70% of total RAM for dedicated server, else 10%.</span>
<span class="token comment"># innodb_buffer_pool_size = 128M</span>
<span class="token comment">#</span>
<span class="token comment"># Remove leading # to turn on a very important data integrity option: logging</span>
<span class="token comment"># changes to the binary log between backups.</span>
<span class="token assign-left variable">log_bin</span><span class="token operator">=</span>mysql-bin
<span class="token comment">#</span>
<span class="token comment"># Remove leading # to set options mainly useful for reporting servers.</span>
<span class="token comment"># The server defaults are faster for transactions and fast SELECTs.</span>
<span class="token comment"># Adjust sizes as needed, experiment to find the optimal values.</span>
<span class="token comment"># join_buffer_size = 128M</span>
<span class="token comment"># sort_buffer_size = 2M</span>
<span class="token comment"># read_rnd_buffer_size = 2M</span>
<span class="token assign-left variable">datadir</span><span class="token operator">=</span>/data/mysql/data
<span class="token assign-left variable">socket</span><span class="token operator">=</span>/var/lib/mysql/mysql.sock

<span class="token comment"># Disabling symbolic-links is recommended to prevent assorted security risks</span>
symbolic-links<span class="token operator">=</span><span class="token number">0</span>

log-error<span class="token operator">=</span>/data/mysql/mysqld.log
pid-file<span class="token operator">=</span>/var/run/mysqld/mysqld.pid


binlog-format<span class="token operator">=</span>mixed

<span class="token comment">#ä¸»æ ‡æœåŠ¡æ ‡è¯†å·,å¿…éœ€å”¯ä¸€</span>
server-id<span class="token operator">=</span><span class="token number">15</span>
<span class="token comment"># å¿½ç•¥å¤§å°å†™</span>
<span class="token assign-left variable">lower_case_table_names</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token comment"># è®°å½•æ—¥å¿—çš„æ•°æ®åº“</span>
binlog-do-db<span class="token operator">=</span>zngh

<span class="token comment">#ä¸è®°å½•æ—¥å¿—çš„åº“,å³ä¸éœ€è¦åŒæ­¥çš„åº“</span>

binlog-ignore-db<span class="token operator">=</span>mysql
<span class="token comment">#ç”¨ä»å±æœåŠ¡å™¨ä¸Šçš„æ—¥å¿—åŠŸèƒ½</span>

log-slave-updates

<span class="token comment">#ç»è¿‡1æ—¥å¿—å†™æ“ä½œå°±æŠŠæ—¥å¿—æ–‡ä»¶å†™å…¥ç¡¬ç›˜ä¸€æ¬¡(å¯¹æ—¥å¿—ä¿¡æ¯è¿›è¡Œä¸€æ¬¡åŒæ­¥)ã€‚n=1æ˜¯æœ€å®‰å…¨çš„åšæ³•ï¼Œä½†æ•ˆç‡æœ€ä½ã€‚é»˜è®¤è®¾ç½®æ˜¯n=0ã€‚</span>

<span class="token assign-left variable">sync_binlog</span><span class="token operator">=</span><span class="token number">1</span>

<span class="token comment"># auto_incrementï¼Œæ§åˆ¶è‡ªå¢åˆ—AUTO_INCREMENTçš„è¡Œä¸º</span>
<span class="token comment"># auto_increment_offsetï¼1è®¾ç½®æ­¥é•¿,è¿™é‡Œè®¾ç½®ä¸º1,è¿™æ ·Masterçš„auto_incrementå­—æ®µäº§ç”Ÿçš„æ•°å€¼æ˜¯:1, 3, 5, 7, â€¦ç­‰å¥‡æ•°ID</span>
<span class="token assign-left variable">auto_increment_offset</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token comment"># auto_increment_increment=næœ‰å¤šå°‘å°æœåŠ¡å™¨ï¼Œnå°±è®¾ç½®ä¸ºå¤šå°‘</span>
<span class="token assign-left variable">auto_increment_increment</span><span class="token operator">=</span><span class="token number">2</span>

<span class="token comment">#è¿›è¡Œé•œåƒå¤„ç†çš„æ•°æ®åº“</span>

replicate-do-db <span class="token operator">=</span> zngh

<span class="token comment">#ä¸è¿›è¡Œé•œåƒå¤„ç†çš„æ•°æ®åº“</span>

replicate-ignore-db<span class="token operator">=</span> mysql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br></div></div><h5 id="æŸ¥çœ‹14æ•°æ®åº“åç§»"><a href="#æŸ¥çœ‹14æ•°æ®åº“åç§»" class="header-anchor">#</a> æŸ¥çœ‹14æ•°æ®åº“åç§»</h5> <p>rootè´¦å·è¿›å…¥14æ•°æ®åº“æŸ¥çœ‹åç§»é‡</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>mysql <span class="token operator">&gt;</span> show master status<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-mysql line-numbers-mode"><pre class="language-text"><code>+------------------+----------+--------------+------------------+-------------------+
| File             | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set |
+------------------+----------+--------------+------------------+-------------------+
| mysql-bin.000004 |  1258644 | zngh         | mysql            |                   |
+------------------+----------+--------------+------------------+-------------------
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h5 id="_15æ•°æ®åº“è®¾ç½®åŒæ­¥"><a href="#_15æ•°æ®åº“è®¾ç½®åŒæ­¥" class="header-anchor">#</a> 15æ•°æ®åº“è®¾ç½®åŒæ­¥</h5> <div class="language-mysql line-numbers-mode"><pre class="language-text"><code>stop slave;
change master to master_host='10.154.73.14', master_user='replicate', master_password='9FurhTCnIwZtAgqR', master_log_file='mysql-bin.000004', master_log_pos=1258644;
start slave;
show slave status\G;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="fastfds-æ–‡ä»¶æœåŠ¡å™¨"><a href="#fastfds-æ–‡ä»¶æœåŠ¡å™¨" class="header-anchor">#</a> fastfds æ–‡ä»¶æœåŠ¡å™¨</h2> <p>ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨çš„/dataç›®å½•</p> <p>éœ€è¦å®‰è£…çš„æœåŠ¡å™¨æœ‰</p> <ol><li>10.154.73.11</li> <li>10.154.73.12</li> <li>10.154.73.13</li></ol> <h3 id="å¼€æ”¾ç«¯å£-4"><a href="#å¼€æ”¾ç«¯å£-4" class="header-anchor">#</a> å¼€æ”¾ç«¯å£</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code> firewall-cmd --add-port<span class="token operator">=</span><span class="token number">22122</span>/tcp --permanent <span class="token operator">&amp;&amp;</span>  firewall-cmd --add-port<span class="token operator">=</span><span class="token number">23000</span>/tcp --permanent <span class="token operator">&amp;&amp;</span> firewall-cmd --reload
 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="è§£å‹å®‰è£…"><a href="#è§£å‹å®‰è£…" class="header-anchor">#</a> è§£å‹å®‰è£…</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>yum <span class="token function">install</span> <span class="token function">unzip</span> -y
<span class="token function">unzip</span> /data/libfastcommon-master.zip -d /data/fastdfs
<span class="token function">unzip</span> /data/fastdfs-master.zip -d /data/fastdfs
<span class="token builtin class-name">cd</span> /data/fastdfs/libfastcommon-master/ <span class="token operator">&amp;&amp;</span> ./make.sh <span class="token operator">&amp;&amp;</span> ./make.sh <span class="token function">install</span> 
<span class="token builtin class-name">cd</span> /data/fastdfs/fastdfs-master/ <span class="token operator">&amp;&amp;</span> ./make.sh <span class="token operator">&amp;&amp;</span> ./make.sh <span class="token function">install</span>
 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="åˆ›å»ºæ–‡ä»¶å¤¹"><a href="#åˆ›å»ºæ–‡ä»¶å¤¹" class="header-anchor">#</a> åˆ›å»ºæ–‡ä»¶å¤¹</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">mkdir</span> -p /data/fastdfs/data/tracker
<span class="token function">mkdir</span> -p /data/fastdfs/data/storage

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="æ‹·è´é…ç½®æ–‡ä»¶"><a href="#æ‹·è´é…ç½®æ–‡ä»¶" class="header-anchor">#</a> æ‹·è´é…ç½®æ–‡ä»¶</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">cp</span> /etc/fdfs/tracker.conf.sample /etc/fdfs/tracker.conf <span class="token operator">&amp;&amp;</span> <span class="token function">cp</span> /etc/fdfs/storage.conf.sample /etc/fdfs/storage.conf <span class="token operator">&amp;&amp;</span> <span class="token function">cp</span> /etc/fdfs/client.conf.sample /etc/fdfs/client.conf

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="é…ç½®tracker"><a href="#é…ç½®tracker" class="header-anchor">#</a> é…ç½®tracker</h3> <p>ä¿®æ”¹é…ç½®æ–‡ä»¶*/etc/fdfs/tracker.conf* ä¿®æ”¹ä½ç½®æœ‰</p> <div class="language- extra-class"><pre><code>1. 22è¡Œï¼š`base_path=/data/fastdfs/data/tracker`
2. 54è¡Œï¼š`store_group=group`
3. 98è¡Œï¼š`run_by_group=root`
4. 102è¡Œï¼š`run_by_user=root`
</code></pre></div><h3 id="é…ç½®storage"><a href="#é…ç½®storage" class="header-anchor">#</a> é…ç½®storage</h3> <p>ä¿®æ”¹é…ç½®æ–‡ä»¶*/etc/fdfs/storage.conf* ä¿®æ”¹ä½ç½®æœ‰</p> <ol><li>11è¡Œï¼š<code>group_name=group</code></li> <li>41è¡Œï¼š<code>base_path=/data/fastdfs/data/storage</code></li> <li>111è¡Œï¼š<code>store_path0=/data/fastdfs/data/storage</code></li> <li>119è¡Œï¼š<code>tracker_server=10.154.73.11:22122,10.154.73.12:22122,10.154.73.13:22122</code></li> <li>134è¡Œï¼š<code>run_by_group=root</code></li> <li>138è¡Œï¼š<code>run_by_user=root</code></li></ol> <h3 id="å¯åŠ¨-5"><a href="#å¯åŠ¨-5" class="header-anchor">#</a> å¯åŠ¨</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>/usr/bin/fdfs_trackerd /etc/fdfs/tracker.conf start <span class="token operator">&amp;&amp;</span> /usr/bin/fdfs_storaged /etc/fdfs/storage.conf start

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="æŸ¥çœ‹é›†ç¾¤çŠ¶æ€-2"><a href="#æŸ¥çœ‹é›†ç¾¤çŠ¶æ€-2" class="header-anchor">#</a> æŸ¥çœ‹é›†ç¾¤çŠ¶æ€</h3> <p>åœ¨10.154.73.11æœåŠ¡å™¨ä¸ŠæŸ¥çœ‹çŠ¶æ€</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>fdfs_monitor /etc/fdfs/client.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="kafka-å®‰è£…"><a href="#kafka-å®‰è£…" class="header-anchor">#</a> kafka å®‰è£…</h2> <h3 id="å¼€æ”¾ç«¯å£-5"><a href="#å¼€æ”¾ç«¯å£-5" class="header-anchor">#</a> å¼€æ”¾ç«¯å£</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>firewall-cmd --add-port<span class="token operator">=</span><span class="token number">9093</span>/tcp --permanent <span class="token operator">&amp;&amp;</span> firewall-cmd --reload

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>æœ¬æ¬¡å®‰è£…ç‰ˆæœ¬ä¸ºï¼š2.12</p> <p>éœ€è¦å®‰è£…çš„æœåŠ¡å™¨æœ‰</p> <ol><li>10.154.73.11</li> <li>10.154.73.12</li> <li>10.154.73.13</li></ol> <h3 id="å®‰è£…-6"><a href="#å®‰è£…-6" class="header-anchor">#</a> å®‰è£…</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">tar</span> -xvf /data/kafka_2.12-2.5.0.tgz -C /data

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="ä¿®æ”¹é…ç½®æ–‡ä»¶-3"><a href="#ä¿®æ”¹é…ç½®æ–‡ä»¶-3" class="header-anchor">#</a> ä¿®æ”¹é…ç½®æ–‡ä»¶</h3> <p>ä¿®æ”¹é…ç½®æ–‡ä»¶ <code>vim /data/kafka_2.12-2.5.0/config/server.properties</code></p> <ol><li>21è¡Œï¼š<code>broker.id=11</code> æ¯å°æœåŠ¡å™¨ä¸ä¸€æ ·</li> <li>31è¡Œï¼š<code>listeners=PLAINTEXT://10.154.73.11:9092</code> æ¯å°æœåŠ¡å™¨ä¸ä¸€æ ·</li> <li>60è¡Œï¼š<code>log.dirs=/data/kafka/kafka-logs</code></li> <li>123è¡Œï¼š<code>10.154.73.11:2181,10.154.73.12:2181,10.154.73.13:2181/kafka</code></li> <li>126è¡Œï¼š<code>zookeeper.connection.timeout.ms=60000</code></li> <li></li></ol> <h3 id="å¯åŠ¨-6"><a href="#å¯åŠ¨-6" class="header-anchor">#</a> å¯åŠ¨</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>/data/kafka_2.12-2.5.0/bin/kafka-server-start.sh -daemon  /data/kafka_2.12-2.5.0/config/server.properties
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="kkfileview-æ–‡ä»¶é¢„è§ˆæœåŠ¡å™¨"><a href="#kkfileview-æ–‡ä»¶é¢„è§ˆæœåŠ¡å™¨" class="header-anchor">#</a> kkFileView æ–‡ä»¶é¢„è§ˆæœåŠ¡å™¨</h2> <p>ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨/dataç›®å½•</p> <h3 id="å¼€æ”¾ç«¯å£-6"><a href="#å¼€æ”¾ç«¯å£-6" class="header-anchor">#</a> å¼€æ”¾ç«¯å£</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code> firewall-cmd --add-port<span class="token operator">=</span><span class="token number">7205</span>/tcp --permanent <span class="token operator">&amp;&amp;</span> firewall-cmd --reload
 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="å®‰è£…-7"><a href="#å®‰è£…-7" class="header-anchor">#</a> å®‰è£…</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">unzip</span> /data/kkFileView-2.2.1.zip -d /data
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="ä¿®æ”¹é…ç½®"><a href="#ä¿®æ”¹é…ç½®" class="header-anchor">#</a> ä¿®æ”¹é…ç½®</h3> <p>ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼š<code>vim /data/kkFileView-2.2.1/config/application.properties</code></p> <ol><li>2è¡Œï¼š<code>server.port = ${KK_SERVER_PORT:7205}</code></li> <li>30è¡Œï¼š<code>cache.type = ${KK_CACHE_TYPE:default}</code></li> <li>97è¡Œï¼š<code>union.module.file.fastdfs.tracker-servers=10.154.73.11:22122,10.154.73.12:22122,10.154.73.13:22122</code></li></ol> <h3 id="å®‰è£…openoffice"><a href="#å®‰è£…openoffice" class="header-anchor">#</a> å®‰è£…openoffice</h3> <ol><li><p>ä¸Šä¼ æ–‡ä»¶åˆ°/dataç›®å½•</p></li> <li><p>å®‰è£…</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">tar</span> -xzvf Apache_OpenOffice_4.1.7_Linux_x86-64_install-rpm_zh-CN.tar.gz -C /data
<span class="token function">rpm</span> -Uvih /data/zh-CN/RPMS/*.rpm
<span class="token function">rpm</span> -Uvih /data/zh-CN/RPMS/desktop-integration/openoffice4.1.7-redhat-menus-4.1.7-9800.noarch.rpm
yum <span class="token function">install</span> xorg-x11-server-Xvfb -y

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li></ol> <h3 id="å¯åŠ¨-7"><a href="#å¯åŠ¨-7" class="header-anchor">#</a> å¯åŠ¨</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>/data/kkFileView-2.2.1/bin/startup.sh
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="ä¸Šä¼ å¯åŠ¨è„šæœ¬"><a href="#ä¸Šä¼ å¯åŠ¨è„šæœ¬" class="header-anchor">#</a> ä¸Šä¼ å¯åŠ¨è„šæœ¬</h2> <p>éœ€è¦æ‰§è¡Œçš„æœåŠ¡å™¨ä¸ºåº”ç”¨æœåŠ¡å™¨ï¼š</p> <ol><li>10.154.73.11</li> <li>10.154.73.12</li> <li>10.154.73.13</li></ol> <h3 id="åˆ›å»ºç›®å½•"><a href="#åˆ›å»ºç›®å½•" class="header-anchor">#</a> åˆ›å»ºç›®å½•</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">mkdir</span> -p /data/union/znpro/log <span class="token operator">&amp;&amp;</span> <span class="token function">mkdir</span> /shareddisk/union
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="å¯åŠ¨è„šæœ¬"><a href="#å¯åŠ¨è„šæœ¬" class="header-anchor">#</a> å¯åŠ¨è„šæœ¬</h3> <p>ç”¨äºå¯åŠ¨å•ä¸ªåº”ç”¨</p> <p>è„šæœ¬åç§°ä¸ºï¼š/shareddisk/union/springbootstartup.sh</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">vim</span> /shareddisk/union/springbootstartup.sh
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å†…å®¹ä¸ºï¼šunion.env.zookeeperä¸ºzookeeperåœ°å€éœ€è¦æ ¹æ®æƒ…å†µæ›¿æ¢</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token shebang important">#!/bin/sh</span>
<span class="token assign-left variable">version</span><span class="token operator">=</span><span class="token number">1.0</span>.0
<span class="token keyword">while</span> <span class="token builtin class-name">getopts</span> <span class="token string">&quot;:a:p:n:f:v&quot;</span> opt
<span class="token keyword">do</span>
    <span class="token keyword">case</span> <span class="token variable">$opt</span> <span class="token keyword">in</span>
    	<span class="token comment">#å¯åŠ¨ç«¯å£</span>
        a<span class="token punctuation">)</span>
		<span class="token assign-left variable">active</span><span class="token operator">=</span><span class="token variable">$OPTARG</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;å¯åŠ¨ç¯å¢ƒçš„å€¼ï¼š<span class="token variable">$OPTARG</span>&quot;</span>
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    	<span class="token comment">#å¯åŠ¨ç«¯å£</span>
        p<span class="token punctuation">)</span>
		<span class="token assign-left variable">startup_port</span><span class="token operator">=</span><span class="token variable">$OPTARG</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;å¯åŠ¨ç«¯å£çš„å€¼ï¼š<span class="token variable">$OPTARG</span>&quot;</span>
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
        <span class="token comment">#æœåŠ¡åç§°</span>
        n<span class="token punctuation">)</span>
		<span class="token assign-left variable">server_name</span><span class="token operator">=</span><span class="token variable">$OPTARG</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;å¯åŠ¨æœåŠ¡åç§°çš„å€¼ï¼š<span class="token variable">$OPTARG</span>&quot;</span>
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
        <span class="token comment">#æ–‡ä»¶è·¯å¾„</span>
        f<span class="token punctuation">)</span>
		<span class="token assign-left variable">path_name</span><span class="token operator">=</span><span class="token variable">$OPTARG</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;æ–‡ä»¶è·¯å¾„ä¸ºï¼š<span class="token variable">$OPTARG</span>&quot;</span>
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
        <span class="token function">v</span><span class="token punctuation">)</span>
        <span class="token assign-left variable">version</span><span class="token operator">=</span><span class="token variable">$OPTARG</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;ç‰ˆæœ¬ä¸ºï¼š<span class="token variable">$OPTARG</span>&quot;</span>
    <span class="token keyword">esac</span>
<span class="token keyword">done</span>
<span class="token builtin class-name">cd</span> <span class="token variable">$path_name</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;Stopping SpringBoot Application&quot;</span>
<span class="token assign-left variable">pid</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">ps</span> -ef <span class="token operator">|</span> <span class="token function">grep</span> union-module-$server_name-$version-SNAPSHOT.jar <span class="token operator">|</span> <span class="token function">grep</span> -v <span class="token function">grep</span> <span class="token operator">|</span><span class="token function">grep</span> $startup_port <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print <span class="token variable">$2</span>}'</span><span class="token variable">`</span></span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> -n <span class="token string">&quot;<span class="token variable">$pid</span>&quot;</span> <span class="token punctuation">]</span>
<span class="token keyword">then</span>
   <span class="token function">kill</span> -9 <span class="token variable">$pid</span>
<span class="token keyword">fi</span>
<span class="token function">rm</span> -rf <span class="token variable">$path_name</span>/log/<span class="token variable">$server_name</span>-<span class="token variable">$startup_port</span>*.log
<span class="token function">sleep</span> 1s
<span class="token function">nohup</span> java -Xms200m -Xmx1000m -Xss256k -XX:ParallelGCThreads<span class="token operator">=</span><span class="token number">2</span> -Djava.compiler<span class="token operator">=</span>NONE -XX:+UseParallelOldGC -jar <span class="token variable">$path_name</span>/union-module-<span class="token variable">$server_name</span>-<span class="token variable">$version</span>-SNAPSHOT.jar --union.env.zookeeper<span class="token operator">=</span><span class="token number">10.154</span>.73.11:2181,10.154.73.12:2181,10.154.73.13:2181 --server.port<span class="token operator">=</span><span class="token variable">$startup_port</span> --spring.profiles.active<span class="token operator">=</span><span class="token variable">$active</span>  --spring.cloud.zookeeper.config.root<span class="token operator">=</span>union_config_<span class="token variable">$active</span><span class="token operator">&gt;&gt;</span><span class="token variable">$path_name</span>/log/<span class="token variable">$server_name</span>-<span class="token variable">$startup_port</span>-<span class="token variable"><span class="token variable">`</span><span class="token function">date</span> +%Y-%m-%d<span class="token variable">`</span></span>.log <span class="token operator">&amp;</span> <span class="token operator">&gt;&gt;</span><span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><h3 id="æ‰¹é‡è¿è¡Œè„šæœ¬"><a href="#æ‰¹é‡è¿è¡Œè„šæœ¬" class="header-anchor">#</a> æ‰¹é‡è¿è¡Œè„šæœ¬</h3> <p>ç”¨äºå¯åŠ¨æ‰€æœ‰åº”ç”¨</p> <p>è„šæœ¬åç§°ä¸ºï¼š/shareddisk/union/startup.sh</p> <p>è„šæœ¬å†…å®¹ä¸ºï¼š</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token shebang important">#!/bin/sh</span>
/shareddisk/union/springbootstartup.sh -a znpro -p <span class="token number">8040</span> -n activiti-starter -f /bak/union/znpro
/shareddisk/union/springbootstartup.sh -a znpro -p <span class="token number">8155</span> -n auto-component-starter -f /bak/union/znpro
/shareddisk/union/springbootstartup.sh -a znpro -p <span class="token number">8016</span> -n configcenter-starter -f /bak/union/znpro
/shareddisk/union/springbootstartup.sh -a znpro -p <span class="token number">8015</span> -n eureka-server-starter -f /bak/union/znpro
/shareddisk/union/springbootstartup.sh -a znpro -p <span class="token number">8035</span> -n gateway-starter -f /bak/union/znpro
/shareddisk/union/springbootstartup.sh -a znpro -p <span class="token number">8025</span> -n oauth2-server-starter -f /bak/union/znpro
/shareddisk/union/springbootstartup.sh -a znpro -p <span class="token number">8060</span> -n public-service-starter -f /bak/union/znpro
/shareddisk/union/springbootstartup.sh -a znpro -p <span class="token number">8185</span> -n operation-log-starter -f /bak/union/znpro
/shareddisk/union/springbootstartup.sh -a znpro -p <span class="token number">8215</span> -n message-manager-service-starter -f /bak/union/znpro
/shareddisk/union/springbootstartup.sh -a znpro -p <span class="token number">8230</span> -n base-union-starter -f /bak/union/znpro
/shareddisk/union/springbootstartup.sh -a znpro -p <span class="token number">8235</span> -n base-difficult-help-starter -f /bak/union/znpro
/shareddisk/union/springbootstartup.sh -a znpro -p <span class="token number">8220</span> -n membercost-capture-starter -f /bak/union/znpro
/shareddisk/union/springbootstartup.sh -a znpro -p <span class="token number">8265</span> -n base-staff-user-starter -f /bak/union/znpro
/shareddisk/union/springbootstartup.sh -a znpro -p <span class="token number">8255</span> -n base-democratic-management-platform-starter -f /bak/union/znpro
/shareddisk/union/springbootstartup.sh -a znpro -p <span class="token number">8245</span> -n base-funds-starter -f /bak/union/znpro
/shareddisk/union/springbootstartup.sh -a znpro -p <span class="token number">8260</span> -n base-model-worker-starter -f /bak/union/znpro
/shareddisk/union/springbootstartup.sh -a znpro -p <span class="token number">8250</span> -n base-women-staff-starter -f /bak/union/znpro
/shareddisk/union/springbootstartup.sh -a znpro -p <span class="token number">8270</span> -n base-culturalsports-starter -f /bak/union/znpro
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="æ‰§è¡Œèµ‹æƒ"><a href="#æ‰§è¡Œèµ‹æƒ" class="header-anchor">#</a> æ‰§è¡Œèµ‹æƒ</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">chmod</span> +x /shareddisk/union/springbootstartup.sh <span class="token operator">&amp;&amp;</span> <span class="token function">chmod</span> +x /shareddisk/union/startup.sh
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.0cb9d00b.js" defer></script><script src="/blog/assets/js/2.d26acfa2.js" defer></script><script src="/blog/assets/js/14.0983790a.js" defer></script>
  </body>
</html>
